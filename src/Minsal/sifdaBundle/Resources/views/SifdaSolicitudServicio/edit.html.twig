{% extends 'MinsalsifdaBundle::layoutSolicitante.html.twig' %}

{% block contenido_in  %}
    {% if entity.idEstado.id == 1 %}
    {{form_start(edit_form)}}
    {{form_errors(edit_form)}}
    
    <div class="row-fluid">
    <div class="page-header">
        <center><h3>Modificar solicitud de servicio</h3></center>
    </div>
        
        <div class="span12">
            <div class="row-fluid">
                <div class="span4 offset2">
                    {{form_row(edit_form.establecimiento, {'attr': {'class':'span7'} })}}
                    {{form_row(edit_form.dependencia, {'attr': {'class':'span7'} })}}
                    {{form_row(edit_form.idTipoServicio)}}                    
                </div>                   
                <div class="span5 offset1">
                    {{form_row(edit_form.descripcion)}}
                    {#{{form_row(edit_form.fechaRequiere, {'attr':{'readonly':'yes'}} )}}#}
                    {{form_row(edit_form.fechaRequiere,{'attr': {'readonly':'yes', 'onclick':'buscarFechasFeriado("../../ctlferiado/llenarCalendario") '} })}}
                </div>
            </div>
            <br><br>
            <center>

                <table id="botones">
                    <tr>
                        <td>{{form_row(edit_form.submit,{'attr':{'class':'btn btn-primary'}})}}</td>
                        <td><a href="{{ path('sifda_solicitudservicio')}}" class="btn">Regresar</a></td>
                    </tr>  
                </table>            
            </center>
            
      </div> 
                    
   </div>
    {{form_end(edit_form)}}
    {% else %}
        <div class="row-fluid">
            <div class="page-header">
                <center><h3>Informacion de solicitud de servicio</h3></center>
            </div>
            {#<div class="row-fluid">#}
            <div class="span12">
                <div class="row-fluid">
                <table id="tabla" class="table table-bordered table-hover table-condensed">
                    <tbody>
                        <tr>
                            <th>Establecimiento</th>
                            <td>{{ entity.idDependenciaEstablecimiento.idEstablecimiento.nombre }}</td>
                        </tr>
                        <tr>
                            <th>Dependencia</th>
                            <td>{{ entity.idDependenciaEstablecimiento.idDependencia.nombre }}</td>
                        </tr>
                        <tr>
                            <th>Tipo de servicio</th>
                            <td>{{ entity.idTipoServicio }}</td>
                        </tr>
                        <tr>
                            <th>Descripcion</th>
                            <td>{{ entity.descripcion }}</td>
                        </tr>
                        <tr>
                            <th>Fecha que se requiere</th>
                            <td>{{ entity.fechaRequiere|date('d/m/Y') }}</td>
                        </tr>
                        <tr>
                            <th>Estado de la solicitud de servicio</th>
                            <td>{{ entity.idEstado }}</td>
                        </tr>
                    </tbody>
                </table>
                </div>
            </div>
            <br><br>
            <center><h4>El servicio solicitado no puede ser modificado porque ya fue {{ entity.idEstado.descripcion }}</h4></center>
            <br>
            <center>

                <table id="botones">
                    <tr>
                        <td><a href="{{ path('sifda_solicitudservicio')}}" class="btn">Regresar</a></td>
                    </tr>  
                </table>            
            </center>
            <br>
        </div>
    {% endif %}
{% endblock %}

{% block javascripts_step %}
    {{ parent() }}
    <script src="{{ asset('bundles/minsalsifda/js/Calendar.js') }}"></script>
    <script>
   
        {#$.datepicker.regional['es'] = {
			 closeText: 'Cerrar',
			 prevText: '<Ant',
			 nextText: 'Sig>',
			 currentText: 'Hoy',
			 monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
			 monthNamesShort: ['Ene','Feb','Mar','Abr', 'May','Jun','Jul','Ago','Sep', 'Oct','Nov','Dic'],
			 dayNames: ['Domingo', 'Lunes', 'Martes', 'Mi�rcoles', 'Jueves', 'Viernes', 'S�bado'],
			 dayNamesShort: ['Dom','Lun','Mar','Mi�','Juv','Vie','S�b'],
			 dayNamesMin: ['Do','Lu','Ma','Mi','Ju','Vi','S�'],
			 weekHeader: 'Sm',
			 showButtonPanel:false,
			 showAnim:'show',
                         changeMonth: true,
			 changeYear: true,
//                         minDate: new Date(1980, 11, 1), 
//                         maxDate: "+0D",
                         dateFormat: 'yy-mm-dd',
			 firstDay: 1,
			 isRTL: false,
			 showMonthAfterYear: false,
			 yearSuffix: ''
			 
			 };
			$.datepicker.setDefaults($.datepicker.regional['es']);
			$(function() {
				$( "#minsal_sifdabundle_sifdasolicitudservicio_fechaRecepcion" ).datepicker(
					
					);
                                
                                $( "#minsal_sifdabundle_sifdasolicitudservicio_fechaRequiere" ).datepicker(
					
					);
				});
#}     
       function buscarFechasFeriado(ruta){
    var fecha = new Date();
    var anio = fecha.getFullYear();
    
//    alert(anio);
//    alert(mes);
//    alert(dia);
    $.post(ruta,
        {
            anio: anio
            },function(data){
                console.log( data );
                calendarAsuetoSolicitud('minsal_sifdabundle_sifdasolicitudservicio_fechaRequiere', data.query)
            }, "json"
        );
                
} 
    
    </script>
    {% endblock%}